Option Explicit

' === Configure workbook/macro pairs ===
Dim tasks
tasks = Array( _
    Array(".\VBA_builder_Template5+.xlsm", "Run_On_File_ByFullPath_over5"), _
    Array(".\VBA_builder_Template.xlsm",  "Run_On_File_ByFullPath_under5") _
)

' === Objects ===
Dim fso, ExcelProgram
Set fso = CreateObject("Scripting.FileSystemObject")
Set ExcelProgram = CreateObject("Excel.Application")

ExcelProgram.Visible = False
ExcelProgram.DisplayAlerts = False

On Error GoTo ErrHandler

' === Run each workbook/macro ===
Dim i
For i = LBound(tasks) To UBound(tasks)
    Dim workbook_path, macro_name, full_workbook_path, wb
    workbook_path = tasks(i)(0)
    macro_name    = tasks(i)(1)

    full_workbook_path = fso.GetAbsolutePathName(workbook_path)

    Set wb = ExcelProgram.Workbooks.Open(full_workbook_path)
    ExcelProgram.Run "'" & full_workbook_path & "'!" & macro_name
    wb.Save
    wb.Close False
    Set wb = Nothing
Next

' === Cleanup ===
CleanUp:
If Not ExcelProgram Is Nothing Then ExcelProgram.Quit
Set ExcelProgram = Nothing
Set fso = Nothing
WScript.Quit 0

' === Error handling ===
ErrHandler:
' Uncomment next line if you want a popup with error details:
' WScript.Echo "Error " & Err.Number & " (" & Err.Description & ")"
Resume CleanUp
