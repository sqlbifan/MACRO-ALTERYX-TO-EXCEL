{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "vconcat": [
    {
      "title": null,
      "data": {"name": "dataset"},
      "width": 240,
      "height": 60,
      "transform": [
        {"calculate": "100", "as": "_background_width"},
        {"calculate": "10", "as": "_circle_padding"},
        {
          "calculate": "datum['SORT FIELD'] == 'ACTUAL' ? datum['_circle_padding'] : datum['_background_width'] - datum['_circle_padding']",
          "as": "_circle_position"
        },
        {
          "calculate": "datum['SORT FIELD'] == 'ACTUAL' ? 'right' : 'left'",
          "as": "_label_align"
        },
        {"calculate": "10", "as": "_label_padding"},
        {
          "calculate": "datum['SORT FIELD'] == 'ACTUAL' ? datum['_background_width'] - datum['_label_padding'] : datum['_label_padding']",
          "as": "_label_position"
        }
      ],
      "layer": [
        {
          "mark": {
            "type": "bar",
            "height": 35,
            "cornerRadius": 20,
            "fill": {"expr": "pbiColor(1)"},
            "stroke": "#000",
            "y": 30
          },
          "encoding": {
            "x": {"field": "_background_width", "type": "quantitative", "axis": null}
          }
        },
        {
          "mark": {"type": "circle", "size": {"expr": "PI * pow(18, 2)"}, "color": "white", "y": 30},
          "encoding": {"x": {"field": "_circle_position", "type": "quantitative"}}
        },
        {
          "mark": {"type": "image", "width": 40, "height": 40, "y": 30},
          "encoding": {"x": {"field": "_circle_position", "type": "quantitative"}, "url": {"field": "ICON"}}
        },
        {
          "mark": {
            "type": "text",
            "align": {"expr": "datum['_label_align']"},
            "fontSize": 16,
            "fontWeight": "bold",
            "color": "white",
            "y": 30
          },
          "encoding": {
            "text": {"field": "DISC", "type": "nominal"},
            "x": {"field": "_label_position", "type": "quantitative"}
          }
        }
      ]
    },
    {
      "title": null,
      "data": {"name": "dataset"},
      "autosize": {"type": "fit-y", "resize": true, "contains": "padding"},
      "height": {"step": 40},
      "width": "container",
      "resolve": {"scale": {"x": "shared", "y": "independent"}},
      "hconcat": [
        {
          "title": {"text": "מרווח", "color": "#B3B3B3"},
          "transform": [
            {"calculate": "-datum['ACTUAL_3']_2", "as": "NEG_ACTUAL_2"},
            {"calculate": "-datum['plan_3']_2", "as": "NEG_plan_2"}
          ],
          "mark": "ba
