{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 240,
  "height": 100,
  "config": {"view": {"stroke": null}},

  "params": [
    {
      "name": "sort_field",
      "value": "ACTUAL"
    }
  ],

  "mark": {"type": "rect"},  // מצריך dataset, לכן נשאיר מבנה בסיסי
  "encoding": {},

  "layer": [
    {
      // רקע משתנה
      "mark": {
        "type": "rect",
        "width": 100,
        "height": 80,
        "cornerRadius": 10,
        "cursor": "pointer"
      },
      "encoding": {
        "x": {"field": "side", "type": "nominal", "axis": null},
        "color": {
          "condition": {"test": "datum.field == sort_field", "value": "#094780"},
          "value": "#E0E0E0"
        }
      }
    },
    {
      // תמונה מהשדה ICONS
      "mark": {
        "type": "image",
        "width": 60,
        "height": 50,
        "cursor": "pointer"
      },
      "encoding": {
        "x": {"field": "side", "type": "nominal"},
        "url": {"field": "ICONS"}
      }
    },
    {
      // טקסט מתחת לתמונה
      "mark": {
        "type": "text",
        "font": "Segoe UI",
        "fontWeight": "bold",
        "size": 14,
        "yOffset": 35,
        "align": "center",
        "cursor": "pointer"
      },
      "encoding": {
        "x": {"field": "side", "type": "nominal"},
        "text": {"field": "side"},
        "color": {
          "condition": {"test": "datum.field == sort_field", "value": "#FFFFFF"},
          "value": "#404040"
        }
      }
    }
  ],

  "selection": {
    "choose_side": {
      "type": "single",
      "fields": ["field"],
      "on": "click",
      "clear": false,
      "init": {"field": "ACTUAL"}
    }
  },

  "transform": [
    {
      "filter": "if(choose_side.field, sort_field=choose_side.field, sort_field)"
    }
  ]
}
